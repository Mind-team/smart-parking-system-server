# Smart Parking System Server
## Регистрация пользователя
### Описание
Предположим, что пользователь решает зарегистрироваться.
Регистрация будет проходить с помощью номера телефона.
Пользователь должен ввести **уникальный** номер телефона (в будущем пользователю
будет приходить смс с кодом подтверждения), пароль, **уникальный** email (опционально),
**уникальный/уникальные** регистрационный/регистрационные номер/номера (в будущем будет проходить
проверка с помощью ТС или через гос. услуги). Схема пользователя находится
в папке `src/schemas/user.schema.ts`. <br>
Многие запросы требуют подтверждения пользователя. Например, я хочу добавить регистрационный номер. 
Сервер должен проверить, что я добавляю этот номер себе, а не кому-то другому. Например, GET запрос на получение
данных о пользователе по номеру телефона. Такое действие доступно только владельцу аккаунта. Для всего этого есть 
JWT токен (можете почитать), но его использовать мы пока не будем. На данный момент, в каждом 
запросе, для котрого требуется валидация пользователя, будет как минимум 2 поля: номер телефона и пароль. 
В бд находим пользователя по номеру телефона, а потом сравниваем его пароль и тот, что пришел к нам из запроса. 
Если пароли совпадают, значит можно выполнять запрос, если нет, то выкидываем ошибку. 
## Запросы для клиента
| Метод | URL | Описание |
| ------------- | ------------- | ------------- |
| POST | `user/signUp` | Создает нового пользователя |
| POST | `user/addPlate` | Добавляет регистрационный номер в документ пользователя |
| POST | `user/signIn` | Возвращает данные пользователя |
## Запросы для Raspberry Pi
| Метод | URL | Описание |
| ------------- | ------------- | ------------- |
| POST | `parking/registerCarEntry` | Регистрация въезда машины на парковку |
## Скрипты
Здесь только те скрипты, которыми нужно пользоваться
- `npm run start:dev` - запуск приложения в режиме разработки (автоматически перезапускается при изменении файла. Также приложение не билдится)
- `npm run start:debug`- запуск приложения в режиме дебага
- `npm run lint` - исправление код стайла (если это возможно)
- `npm run test` - запуск тестов
- `npm run test:watch` - запуск тестов с автообновлениями
- `npm run test:cov` - показывает процент покрытия кода тестами 
- `npm run type:coverage` - количество типов any в вашем коде
## Система ответов
### Интерфейсы
- `ServerResponse` - интерфейс для ответов, которые не должны возвращать какую-либо сущность.
То есть сервер просто должен сообщить об успехе или неудаче
- `FilledServerResponse<T>` - интерфейс для ответов, которые должны возвращать какую-либо 
сущность типа T. То есть сервер должен сообщить об успехе или неудаче и вернуть сущность типа T
  
### Классы
На данный момент существует 3 класса, которые реализуют какой-либо интерфейс
- `SuccessfulServerResponse: ServerResponse`
- `FailedServerResponse: ServerResponse`
- `FilledSuccessfulServerResponse<T>: FilledServerResponse<T>`

Если когда-то понадобится возможность возвращать какую-либо сущность при неудачном ответе,
то нужно реализовать `FilledFailedServerResponse<T>: FilledServerResponse<T>` 
  
### Когда использовать
Сервер обязан ответить на каждый запрос, который ему приходит
- Если от сервера требовалось совершить какое-то действие и сервер с этим справился, 
  то нужно вернуть `SuccessfulServerResponse`
- Если от сервера требовалось соврешить какое-то действие, а сервер с этим не справился,
  то нужно вернуть `FailedServerResponse`
- Если от сервера требовалось совершить какое-то действие, а потом вернуть результат
  этого действия и сервер с этим справился, то нужно вернуть `FilledSuccessfulResponse`
- Если от сервера требовалось совершить какое-то действие, а потом вернуть результат 
  этого действия, а сервер с этим не справился, то нужно вернуть `FilledSuccessfulResponse`
  
